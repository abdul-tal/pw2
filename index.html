<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <button onclick="subscribe()">Subscribe</button>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-analytics.js";
      import { getMessaging, getToken } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-messaging.js"

      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
          apiKey: "AIzaSyB39xSxaHiR2YAlwi6Suc1Uek_6L6W-bpw",
          authDomain: "test-firebase-web-push-bb5ad.firebaseapp.com",
          projectId: "test-firebase-web-push-bb5ad",
          storageBucket: "test-firebase-web-push-bb5ad.appspot.com",
          messagingSenderId: "823079035007",
          appId: "1:823079035007:web:b466e764e9e45b2f3b5f4a",
          measurementId: "G-PQN7X9RTEQ"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);

      // Initialize Firebase Cloud Messaging and get a reference to the service
      const messaging = getMessaging(app);

      // Add the public key generated from the console here.

      function subscribe() {
          Notification.requestPermission().then(permission => {
              console.log('permission: ', permission);
              if(permission === 'granted') {
                console.log('getToken', getToken)
                  getToken(messaging, {
                      vapidKey: "BGdQF9AfPCbW5CNJgqmrzE_TMICsuyGeN0qmqwtbSUkok7fMODyLwzbLwwTAv9DEhC47M7EkjLNDSX0owAtnPoY"
                  }).then(currentToken => {
                      console.log('currentToken: ', currentToken)
                  }).catch(err => console.log('errr', err))
              }
          })
      }
      window.subscribe = subscribe;
    </script>

    <!-- <script>
      async function subscribe() {
        let sw = await navigator.serviceWorker.ready;
        let push = await sw.pushManager.subscribe({
          userVisibleOnly: true,
          applicationServerKey:
            'BNgIM2bPgDqArtLaOlhmYZtDYmD3TTMzudNwc6tD6Yz9H6PoOcu2Xm8-MHlHcgzMB8D2yNUYcx_c-Hpcq0QKTI8'
        });
        console.log(JSON.stringify(push));
      }

      if ('serviceWorker' in navigator) {
        addEventListener('load', async () => {
          let sw = await navigator.serviceWorker.register('./push-worker.js');
          console.log(sw);
        });
      }
    </script>
        <script type="text/javascript">
          // 86acbd31cd7c09cf30acb66d2fbedc91daa48b86:1661266792.7283144
          !function(n,r,e,t,c){var i,o="Promise"in n,u={then:function(){return u},catch:function(n){
          return n(new Error("Airship SDK Error: Unsupported browser")),u}},s=o?new Promise((function(n,r){i=function(e,t){e?r(e):n(t)}})):u
          ;s._async_setup=function(n){if(o)try{i(null,n(c))}catch(n){i(n)}},n[t]=s;var a=r.createElement("script");a.src=e,a.async=!0,a.id="_uasdk",
          a.rel=t,r.head.appendChild(a)}(window,document,'https://aswpsdkus.com/notify/v1/ua-sdk.min.js',
            'UA', {
              vapidPublicKey: 'BEhAhDAiRdJSxWzy0AVRuu17DiBTf37mr7g3TBcpzPTbb8lDWnoumKr9wXsecCn-YUh7l5SdrfuOk_Pen4moggc=',
              
              
              appKey: '2ieSnJLsT3GZgrNuILEqpQ',
              token: 'MToyaWVTbkpMc1QzR1pnck51SUxFcXBROm9aenhPTEtfcWdTUEhzenFwa3B2OXpyOE0xY201blpZNTd6d0g0UzhuVjQ'
            });
          
          </script> -->
  </body>
</html>
